(function(e){function t(t){for(var n,r,o=t[0],h=t[1],c=t[2],f=0,u=[];f<o.length;f++)r=o[f],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(e[n]=h[n]);l&&l(t);while(u.length)u.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var h=a[o];0!==i[h]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},i={mqtt:0},s=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],h=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=h;s.push([3,"chunk-vendors","chunk-common"]),a()})({"26e3":function(e,t,a){"use strict";var n=a("ed4d"),i=a.n(n);i.a},3:function(e,t,a){e.exports=a("cee3")},b445:function(e,t,a){"use strict";var n=a("c10f"),i=a.n(n);i.a},c10f:function(e,t,a){},cee3:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n,i=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("chats-wrapper",{attrs:{chat:e.chatData,"show-chats":e.showChats,"no-live-tips":e.guideText,"max-input-character":e.maxInputCharactor,"disable-input":e.isFacebook||!e.showChats||!e.isLiving||e.isPlatformClose},on:{"live-init":e.handleLiveInit,"live-end":e.handleLiveEnd,"live-platform-close":e.handlePlatformClose,"chat-receive":e.handleChat,"handle-send":e.handleSend,"handle-show-tab":e.showFacebookToast,"handle-permission":e.handlePermission},scopedSlots:e._u([{key:"chat",fn:function(t){var n=t.item;return[a(e.temp,{tag:"component",attrs:{data:n,"no-channel-image":""}})]}}])})},r=[],o=(a("a4d3"),a("e01a"),a("7db0"),a("4160"),a("caad"),a("b0c0"),a("d3b7"),a("ac1f"),a("2532"),a("3ca3"),a("5319"),a("841c"),a("159b"),a("ddb0"),a("2b3d"),a("de36")),h=a("2f14"),c=a("eb9e"),l=a("7ea6"),f=a("5991"),u=a("993d"),p=a("23e2"),d=a("05f3"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("transition",{attrs:{name:"fade"}},[e.show?a("div",{ref:"toast",staticClass:"toast-rtmp",style:e.position},[a("div",{staticClass:"toast-rtmp-container"},[a("btn-close",{staticClass:"toast-btn-close",attrs:{"is-small":""},on:{click:e.handleToastClose}}),a("span",{domProps:{innerHTML:e._s(e.content)}})],1)]):e._e()])},v=[],b=a("4d06"),g={name:"prismToast",components:{BtnClose:b["a"]},data:function(){return{show:!1,position:"",content:""}},methods:{handleToastClose:function(){this.show=!1}},mounted:function(){var e=this;this.show=!0,setTimeout((function(){e.handleToastClose()}),5e3)}},w=g,P=(a("b445"),a("2877")),C=Object(P["a"])(w,m,v,!1,null,null,null),T=C.exports,y=i["a"].extend(T),A=function(){n=new y({el:document.createElement("div")}),document.body.appendChild(n.$el)},O=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e&&(t.content=e,A(),E(n.$data,t),n.show=!0)};function E(e,t){if(t){for(var a in t)if(t.hasOwnProperty(a)){var n=t[a];void 0!==n&&(e[a]=n)}return e}}var L=O,F={name:"prismMqtt",mixins:[f["a"]],components:{ChatsWrapper:u["a"],TemplateNormal:p["a"],TemplateAfreeca:d["a"]},data:function(){return{channel:"",isLiving:!1,showChats:!1,chatData:[],prismParams:{},pollTime:5e3,bufferManager:null,maxInputCharactor:o["MAX_INPUT_CHARACTER_AFREECATV"],isPlatformClose:!1,isShowFbToast:!1}},computed:{isFacebook:function(){return this.channel===o["CHANNEL"].FACEBOOK},isAfreecaTV:function(){return this.channel===o["CHANNEL"].AFREECATV},channelName:function(){return this.channel&&o["CHANNEL_NAME"][this.channel]},guideText:function(){return this.isLiving?this.$i18n["forbidden"+this.channel]:this.$i18n.noLiveNaver.replace("${platform}",this.channelName)},temp:function(){return this.isAfreecaTV?d["a"]:p["a"]}},methods:{handlePlatformClose:function(e){e.platform===this.channel&&(this.isPlatformClose=!0)},handleLiveInit:function(e){var t=this;this.isLiving||(this.clearPage(),e&&e.platforms&&(this.prismParams=e.platforms.find((function(e){return e.name===t.channel})),this.prismParams&&(this.isLiving=!0,this.bufferManager=new l["a"](this.chatData,{pollTime:this.pollTime}),this.prismParams.isPrivate||(this.showChats=!0,this.showFacebookToast({platform:this.channel})))))},showFacebookToast:function(e){this.isLiving&&e.platform===this.channel&&!this.isShowFbToast&&this.isFacebook&&!this.prismParams.isPrivate&&(L(this.$i18n.facebookNoSend,{position:{bottom:"60px"}}),this.isShowFbToast=!0)},handleLiveEnd:function(){this.isLiving=!1},handleChat:function(e){var t=this;if(this.isLiving){var a=[];e.forEach((function(e){if(e.livePlatform===t.channel)if(t.isFacebook&&t.prismParams.isPrivate&&t.handlePermission({platform:o["CHANNEL"].FACEBOOK,isPrivate:!1}),e.id=Symbol(),e.timeago=Object(c["a"])(e.publishedAt,t.$lang),t.isAfreecaTV){var n=t.handleAfreecatvChat(e,t.prismParams.userId);n&&a.push(n)}else if(t.isFacebook){var i=e.rawMessage=Object(h["a"])(e.rawMessage);e._isSelf=i.from.id&&+i.from.id===+t.prismParams.userId;var s=e.rawMessage.attachment||{};(e.message||"animated_image_share"===s.type&&s.media.source||"sticker"===s.type)&&a.push(e)}else e._isSelf=e.author.isChatOwner,a.push(e)})),this.bufferManager.push(a)}},handleSend:function(e){window.sendToPrism(JSON.stringify({type:"send",data:{platform:this.channel,message:e}}))},handlePermission:function(e){this.isLiving&&this.channel===e.platform&&(e.isPrivate&&!this.prismParams.isPrivate&&this.isFacebook&&L(this.$i18n.forbiddenFACEBOOK,{position:{top:"10px"}}),this.prismParams.isPrivate=e.isPrivate,e.isPrivate?this.isAfreecaTV&&(this.showChats=!1):(this.showChats=!0,this.showFacebookToast({platform:this.channel})))},clearPage:function(){this.isPlatformClose=!1,this.isLiving=!1,this.showChats=!1,this.chatData=[],this.prismParams={},this.isShowFbToast=!1,this.clearBufferManager()},clearBufferManager:function(){this.bufferManager&&(this.bufferManager.clearTimer(),this.bufferManager=null)}},created:function(){var e=new URLSearchParams(document.location.search).get("platform")||"";if(this.channel=e.toLocaleUpperCase(),![o["CHANNEL"].FACEBOOK,o["CHANNEL"].AFREECATV].includes(this.channel))throw new Error("Please take the correct platform name on url")},beforeDestroy:function(){this.clearBufferManager()}},_=F,M=(a("26e3"),Object(P["a"])(_,s,r,!1,null,null,null)),N=M.exports;a("21af");a("58d1").default(i["a"]),a("a514").default(i["a"]),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(N)}}).$mount("#app")},ed4d:function(e,t,a){}});